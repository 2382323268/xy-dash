"use strict";(self["webpackChunkxy_dash_admin"]=self["webpackChunkxy_dash_admin"]||[]).push([[298],{5298:function(e,a,l){l.r(a),l.d(a,{default:function(){return _}});var t=l(3396),n=l(4870),u=l(7412),i=l(7178);const o=e=>((0,t.dD)("data-v-016f137a"),e=e(),(0,t.Cn)(),e),d=["onClick"],r=["onClick"],p=["onClick"],s=o((()=>(0,t._)("span",{style:{"font-size":"larger"}},"您确定要删除这条记录吗？",-1))),m={class:"dialog-footer"},c={class:"dialog-footer"};var v={__name:"index",setup(e){const a=(0,n.iH)(0),l=(0,n.iH)(null),o=(0,n.iH)(null),v=((0,n.iH)(-1),(0,n.iH)([])),w=(0,n.iH)(!1),g=(0,n.iH)(!1),_=(0,n.iH)(-1),f=async()=>{const e=await u.ZP.get("admin_api/v1/migrationCodes",z.value);l.value=e.data.data.records,a.value=e.data.data.total},W=async()=>{const e=await u.ZP.get("admin_api/v1/migrations/list");v.value=e.data.data};W();const k=async()=>{await u.ZP.post("admin_api/v1/migrationCodes/"+_.value+"/delete");w.value=!1,f()},C=e=>{z.value.current=1,z.value.size=e,f()},b=async e=>{await u.ZP.post("admin_api/v1/migrationCodes/"+e+"/download");i.z8.success("操作成功！")},y=async()=>{await u.ZP.post("admin_api/v1/migrationCodes/"+_.value+"/run?remark="+o.value);g.value=!1,_.value=-1,o.value="",f(),i.z8.success("操作成功！")},h=e=>{z.value.current=e,f()},z=(0,n.iH)({name:"",current:1,size:10});return f(),(e,n)=>{const u=(0,t.up)("el-option"),i=(0,t.up)("el-select"),W=(0,t.up)("el-button"),V=(0,t.up)("el-col"),x=(0,t.up)("el-form-item"),H=(0,t.up)("el-form"),U=(0,t.up)("el-row"),P=(0,t.up)("el-table-column"),Z=(0,t.up)("el-table"),D=(0,t.up)("el-pagination"),I=(0,t.up)("el-dialog"),j=(0,t.up)("el-input");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(U,{gutter:20,class:"header"},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{span:9},{default:(0,t.w5)((()=>[(0,t.Wm)(H,{"label-width":"120px"},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{label:"迁移配置名称:"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{class:"m-2",modelValue:z.value.migrationId,"onUpdate:modelValue":n[0]||(n[0]=e=>z.value.migrationId=e),"popper-append-to-body":!0,clearable:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(v.value,(e=>((0,t.wg)(),(0,t.j4)(u,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),(0,t.Wm)(V,{span:1},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{type:"primary",onClick:f},{default:(0,t.w5)((()=>[(0,t.Uk)("搜索")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,t.Wm)(Z,{data:l.value,stripe:"",style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(P,{prop:"migrationName",label:"迁移配置名称",align:"center"}),(0,t.Wm)(P,{prop:"fileName",label:"文件名称",align:"center"}),(0,t.Wm)(P,{prop:"runCount",label:"运行次数",align:"center"}),(0,t.Wm)(P,{prop:"remark",label:"备注",align:"center"}),(0,t.Wm)(P,{prop:"createdTime",label:"创建时间",align:"center"}),(0,t.Wm)(P,{prop:"creater",label:"创建人",align:"center"}),(0,t.Wm)(P,{prop:"data",label:"操作",align:"center"},{default:(0,t.w5)((e=>[(0,t._)("span",{class:"text",onClick:a=>b(e.row.id)},"下载",8,d),(0,t._)("span",{class:"text",onClick:a=>{_.value=e.row.id,w.value=!0}},"删除",8,r),(0,t._)("span",{class:"text ccc","element-loading-text":"拼命加载中",onClick:a=>{_.value=e.row.id,g.value=!0}},"运行",8,p)])),_:1})])),_:1},8,["data"]),(0,t.Wm)(D,{currentPage:z.value.current,"onUpdate:currentPage":n[1]||(n[1]=e=>z.value.current=e),"page-size":z.value.size,"onUpdate:page-size":n[2]||(n[2]=e=>z.value.size=e),"page-sizes":[10,20,30,40,50],layout:"total, sizes, prev, pager, next, jumper",total:a.value,onSizeChange:C,onCurrentChange:h},null,8,["currentPage","page-size","total"]),(0,t.Wm)(I,{modelValue:w.value,"onUpdate:modelValue":n[5]||(n[5]=e=>w.value=e),title:"提示",width:"30%"},{footer:(0,t.w5)((()=>[(0,t._)("span",m,[(0,t.Wm)(W,{onClick:n[3]||(n[3]=e=>w.value=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1}),(0,t.Wm)(W,{type:"primary",onClick:n[4]||(n[4]=e=>k())},{default:(0,t.w5)((()=>[(0,t.Uk)(" 确认 ")])),_:1})])])),default:(0,t.w5)((()=>[s])),_:1},8,["modelValue"]),(0,t.Wm)(I,{modelValue:g.value,"onUpdate:modelValue":n[9]||(n[9]=e=>g.value=e),title:"运行代码",width:"20%"},{footer:(0,t.w5)((()=>[(0,t._)("span",c,[(0,t.Wm)(W,{onClick:n[7]||(n[7]=a=>e.code=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1}),(0,t.Wm)(W,{type:"primary",onClick:n[8]||(n[8]=e=>y())},{default:(0,t.w5)((()=>[(0,t.Uk)(" 确认 ")])),_:1})])])),default:(0,t.w5)((()=>[(0,t.Wm)(H,{"label-width":"50px",stripe:"",style:{width:"260px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{label:"备注"},{default:(0,t.w5)((()=>[(0,t.Wm)(j,{modelValue:o.value,"onUpdate:modelValue":n[6]||(n[6]=e=>o.value=e),clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}},w=l(89);const g=(0,w.Z)(v,[["__scopeId","data-v-016f137a"]]);var _=g}}]);
//# sourceMappingURL=298.c62d938e.js.map