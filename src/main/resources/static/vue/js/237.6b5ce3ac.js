"use strict";(self["webpackChunkxy_dash_admin"]=self["webpackChunkxy_dash_admin"]||[]).push([[237],{3237:function(e,a,l){l.r(a),l.d(a,{default:function(){return m}});var u=l(3396),t=l(4870),d=l(7412),s=l(7178);const o={class:"dialog-footer"};var i={__name:"dialog",props:{id:{type:Number,default:-1,required:!0},dialogTitle:{type:String,default:"",required:!0},dialogVisible:{type:Boolean,default:!1,required:!0}},emits:["update:modelValue","initUserList"],setup(e,{emit:a}){const l=e,i=(0,t.iH)({id:-1,userName:"",password:"",type:0,port:null,name:"",ip:""}),r=(0,t.iH)({userName:[{required:!0,message:"请输入用户名"}],password:[{required:!0,message:"密码不能为空"}],port:[{required:!0,message:"端口不能为空"}],name:[{required:!0,message:"数据源名称不能为空"}],ip:[{required:!0,message:"主机不能为空"}]}),p=(0,t.iH)(null),m=async e=>{const a=await d.ZP.get("admin_api/v1/dataSources/"+e);i.value=a.data.data},n=async()=>{p.value.validate((async e=>{if(e){const e=await d.ZP.post("admin_api/v1/dataBase/connect",i.value);e.data.success?s.z8.success("连接成功！"):s.z8.error("连接失败！")}else console.log("fail")}))};(0,u.YP)((()=>l.dialogVisible),(()=>{let e=l.id;-1!=e?m(e):i.value={id:-1,userName:"",password:"",type:0,port:null,name:"",ip:""}}));const c=()=>{p.value.resetFields(),a("update:modelValue",!1)},f=()=>{p.value.validate((async e=>{if(e)if(-1==i.value.id){let e=await d.ZP.post("admin_api/v1/dataSources",i.value);v(e)}else{let e=await d.ZP.post("admin_api/v1/dataSources/"+i.value.id,i.value);v(e)}else console.log("fail")}))},v=e=>{let l=e.data.success;l?(s.z8.success("执行成功！"),p.value.resetFields(),a("initUserList"),c()):s.z8.error(e.data.msg)};return(a,l)=>{const t=(0,u.up)("el-input"),d=(0,u.up)("el-form-item"),s=(0,u.up)("el-radio"),m=(0,u.up)("el-radio-group"),v=(0,u.up)("el-form"),w=(0,u.up)("el-button"),_=(0,u.up)("el-dialog");return(0,u.wg)(),(0,u.j4)(_,{modelValue:e.dialogVisible,title:e.dialogTitle,width:"30%","clearValidate:":"",onClose:c},{footer:(0,u.w5)((()=>[(0,u.Wm)(w,{class:"test",plain:"",onClick:n},{default:(0,u.w5)((()=>[(0,u.Uk)("测试连接")])),_:1}),(0,u._)("span",o,[(0,u.Wm)(w,{type:"primary",onClick:f},{default:(0,u.w5)((()=>[(0,u.Uk)("确认")])),_:1}),(0,u.Wm)(w,{onClick:c},{default:(0,u.w5)((()=>[(0,u.Uk)("取消")])),_:1})])])),default:(0,u.w5)((()=>[(0,u.Wm)(v,{ref_key:"formRef",ref:p,model:i.value,rules:r.value,"label-width":"100px"},{default:(0,u.w5)((()=>[(0,u.Wm)(d,{label:"数据源名称",prop:"name"},{default:(0,u.w5)((()=>[(0,u.Wm)(t,{modelValue:i.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>i.value.name=e)},null,8,["modelValue"])])),_:1}),(0,u.Wm)(d,{label:"主机",prop:"ip"},{default:(0,u.w5)((()=>[(0,u.Wm)(t,{modelValue:i.value.ip,"onUpdate:modelValue":l[1]||(l[1]=e=>i.value.ip=e)},null,8,["modelValue"])])),_:1}),(0,u.Wm)(d,{label:"端口",style:{width:"180px"},prop:"port"},{default:(0,u.w5)((()=>[(0,u.Wm)(t,{modelValue:i.value.port,"onUpdate:modelValue":l[2]||(l[2]=e=>i.value.port=e)},null,8,["modelValue"])])),_:1}),(0,u.Wm)(d,{label:"用户名",style:{width:"300px"},prop:"userName"},{default:(0,u.w5)((()=>[(0,u.Wm)(t,{modelValue:i.value.userName,"onUpdate:modelValue":l[3]||(l[3]=e=>i.value.userName=e)},null,8,["modelValue"])])),_:1}),(0,u.Wm)(d,{label:"密码",style:{width:"300px"},prop:"password"},{default:(0,u.w5)((()=>[(0,u.Wm)(t,{modelValue:i.value.password,"onUpdate:modelValue":l[4]||(l[4]=e=>i.value.password=e),type:"password"},null,8,["modelValue"])])),_:1}),(0,u.Wm)(d,{label:"类型",prop:"type"},{default:(0,u.w5)((()=>[(0,u.Wm)(m,{modelValue:i.value.type,"onUpdate:modelValue":l[5]||(l[5]=e=>i.value.type=e)},{default:(0,u.w5)((()=>[(0,u.Wm)(s,{label:0},{default:(0,u.w5)((()=>[(0,u.Uk)("mysql")])),_:1}),(0,u.Wm)(s,{label:1},{default:(0,u.w5)((()=>[(0,u.Uk)("sqlserver")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])}}},r=l(89);const p=(0,r.Z)(i,[["__scopeId","data-v-1d95a88f"]]);var m=p}}]);
//# sourceMappingURL=237.6b5ce3ac.js.map