{"version":3,"file":"js/298.c62d938e.js","mappings":"udA8FA,MAAMA,GAAQC,EAAAA,EAAAA,IAAI,GACZC,GAAWD,EAAAA,EAAAA,IAAI,MACfE,GAASF,EAAAA,EAAAA,IAAI,MAEbG,IADKH,EAAAA,EAAAA,KAAK,IACMA,EAAAA,EAAAA,IAAI,KACpBI,GAAeJ,EAAAA,EAAAA,KAAI,GACnBK,GAAUL,EAAAA,EAAAA,KAAI,GACdM,GAAWN,EAAAA,EAAAA,KAAK,GAEhBO,EAAeC,UACnB,MAAMC,QAAYC,EAAAA,GAAAA,IAChB,8BACAC,EAAUC,OAEZX,EAASW,MAAQH,EAAII,KAAKA,KAAKC,QAC/Bf,EAAMa,MAAQH,EAAII,KAAKA,KAAKd,KAAK,EAG7BgB,EAAmBP,UACvB,MAAMC,QAAYC,EAAAA,GAAAA,IAAgB,gCAClCP,EAAcS,MAAQH,EAAII,KAAKA,IAAI,EAErCE,IACA,MAAMC,EAAaR,gBACCE,EAAAA,GAAAA,KAChB,+BAAiCJ,EAASM,MAAQ,WAEpDR,EAAaQ,OAAQ,EACrBL,GAAc,EAEVU,EAAoBC,IACxBP,EAAUC,MAAMO,QAAU,EAC1BR,EAAUC,MAAMM,KAAOA,EACvBX,GAAc,EAEVa,EAAeZ,gBACDE,EAAAA,GAAAA,KAChB,+BAAiCW,EAAK,aAExCC,EAAAA,GAAAA,QAAkB,QAAQ,EAEtBC,EAAMf,gBACQE,EAAAA,GAAAA,KAChB,+BACEJ,EAASM,MACT,eACAV,EAAOU,OAEXP,EAAQO,OAAQ,EAChBN,EAASM,OAAS,EAClBV,EAAOU,MAAQ,GACfL,IACAe,EAAAA,GAAAA,QAAkB,QAAQ,EAEtBE,EAAuBL,IAC3BR,EAAUC,MAAMO,QAAUA,EAC1BZ,GAAc,EAEVI,GAAYX,EAAAA,EAAAA,IAAI,CACpByB,KAAM,GACNN,QAAS,EACTD,KAAM,K,OAERX,I,wvGCvJA,MAAMmB,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://xy-dash-admin/./src/views/code/list/index.vue","webpack://xy-dash-admin/./src/views/code/list/index.vue?4293"],"sourcesContent":["<template>\r\n  <el-row :gutter=\"20\" class=\"header\">\r\n    <el-col :span=\"9\">\r\n      <el-form label-width=\"120px\">\r\n        <el-form-item label=\"迁移配置名称:\">\r\n          <el-select\r\n            class=\"m-2\"\r\n            v-model=\"queryForm.migrationId\"\r\n            :popper-append-to-body=\"true\"\r\n            clearable\r\n          >\r\n            <el-option\r\n              v-for=\"item in migrationList\"\r\n              :key=\"item.id\"\r\n              :label=\"item.name\"\r\n              :value=\"item.id\"\r\n            />\r\n          </el-select>\r\n          <el-col :span=\"1\">\r\n            <el-button type=\"primary\" @click=\"initUserList\">搜索</el-button>\r\n          </el-col>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-col>\r\n  </el-row>\r\n  <el-table :data=\"codeData\" stripe style=\"width: 100%\">\r\n    <el-table-column prop=\"migrationName\" label=\"迁移配置名称\" align=\"center\" />\r\n    <el-table-column prop=\"fileName\" label=\"文件名称\" align=\"center\" />\r\n    <el-table-column prop=\"runCount\" label=\"运行次数\" align=\"center\" />\r\n    <el-table-column prop=\"remark\" label=\"备注\" align=\"center\" />\r\n    <el-table-column prop=\"createdTime\" label=\"创建时间\" align=\"center\" />\r\n    <el-table-column prop=\"creater\" label=\"创建人\" align=\"center\" />\r\n    <el-table-column prop=\"data\" label=\"操作\" align=\"center\">\r\n      <template v-slot=\"scope\">\r\n        <span class=\"text\" @click=\"downloadById(scope.row.id)\">下载</span>\r\n        <span\r\n          class=\"text\"\r\n          @click=\"\r\n            deleteId = scope.row.id;\r\n            dialogDelete = true;\r\n          \"\r\n          >删除</span\r\n        >\r\n        <span\r\n          class=\"text ccc\"\r\n          element-loading-text=\"拼命加载中\"\r\n          @click=\"\r\n            deleteId = scope.row.id;\r\n            runShow = true;\r\n          \"\r\n          >运行</span\r\n        >\r\n      </template>\r\n    </el-table-column>\r\n  </el-table>\r\n\r\n  <el-pagination\r\n    v-model:currentPage=\"queryForm.current\"\r\n    v-model:page-size=\"queryForm.size\"\r\n    :page-sizes=\"[10, 20, 30, 40, 50]\"\r\n    layout=\"total, sizes, prev, pager, next, jumper\"\r\n    :total=\"total\"\r\n    @size-change=\"handleSizeChange\"\r\n    @current-change=\"handleCurrentChange\"\r\n  />\r\n\r\n  <el-dialog v-model=\"dialogDelete\" title=\"提示\" width=\"30%\">\r\n    <span style=\"font-size: larger\">您确定要删除这条记录吗？</span>\r\n    <template #footer>\r\n      <span class=\"dialog-footer\">\r\n        <el-button @click=\"dialogDelete = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"deleteById()\"> 确认 </el-button>\r\n      </span>\r\n    </template>\r\n  </el-dialog>\r\n  <el-dialog v-model=\"runShow\" title=\"运行代码\" width=\"20%\">\r\n    <el-form label-width=\"50px\" stripe style=\"width: 260px\">\r\n      <el-form-item label=\"备注\"\r\n        ><el-input v-model=\"remark\" clearable></el-input></el-form-item\r\n    ></el-form>\r\n    <template #footer>\r\n      <span class=\"dialog-footer\">\r\n        <el-button @click=\"code = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"run()\"> 确认 </el-button>\r\n      </span>\r\n    </template>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, watch } from \"vue\";\r\nimport requestUtil from \"@/util/request\";\r\nimport { ElMessage } from \"element-plus\";\r\n\r\nconst total = ref(0);\r\nconst codeData = ref(null);\r\nconst remark = ref(null);\r\nconst id = ref(-1);\r\nconst migrationList = ref([]);\r\nconst dialogDelete = ref(false);\r\nconst runShow = ref(false);\r\nconst deleteId = ref(-1);\r\n\r\nconst initUserList = async () => {\r\n  const res = await requestUtil.get(\r\n    \"admin_api/v1/migrationCodes\",\r\n    queryForm.value\r\n  );\r\n  codeData.value = res.data.data.records;\r\n  total.value = res.data.data.total;\r\n};\r\n\r\nconst getMigrationList = async () => {\r\n  const res = await requestUtil.get(\"admin_api/v1/migrations/list\");\r\n  migrationList.value = res.data.data;\r\n};\r\ngetMigrationList();\r\nconst deleteById = async () => {\r\n  const res = await requestUtil.post(\r\n    \"admin_api/v1/migrationCodes/\" + deleteId.value + \"/delete\"\r\n  );\r\n  dialogDelete.value = false;\r\n  initUserList();\r\n};\r\nconst handleSizeChange = (size) => {\r\n  queryForm.value.current = 1;\r\n  queryForm.value.size = size;\r\n  initUserList();\r\n};\r\nconst downloadById = async (id) => {\r\n  const res = await requestUtil.post(\r\n    \"admin_api/v1/migrationCodes/\" + id + \"/download\"\r\n  );\r\n  ElMessage.success(\"操作成功！\");\r\n};\r\nconst run = async () => {\r\n  const res = await requestUtil.post(\r\n    \"admin_api/v1/migrationCodes/\" +\r\n      deleteId.value +\r\n      \"/run?remark=\" +\r\n      remark.value\r\n  );\r\n  runShow.value = false;\r\n  deleteId.value = -1;\r\n  remark.value = \"\";\r\n  initUserList();\r\n  ElMessage.success(\"操作成功！\");\r\n};\r\nconst handleCurrentChange = (current) => {\r\n  queryForm.value.current = current;\r\n  initUserList();\r\n};\r\nconst queryForm = ref({\r\n  name: \"\",\r\n  current: 1,\r\n  size: 10,\r\n});\r\ninitUserList();\r\n</script>\r\n\r\n<style scoped>\r\n.header {\r\n  padding-bottom: 16px;\r\n  box-sizing: border-box;\r\n}\r\n.text {\r\n  cursor: pointer;\r\n  font-size: 0.8rem;\r\n  font-weight: 550;\r\n  background-size: 40px 40px;\r\n  margin: 5px;\r\n  color: #09909f;\r\n}\r\n.m-2 {\r\n  width: 200px;\r\n}\r\n.el-pagination {\r\n  float: right;\r\n  padding: 20px;\r\n  box-sizing: border-box;\r\n}\r\n\r\n::v-deep th.el-table__cell {\r\n  word-break: break-word;\r\n  background-color: #f8f8f9 !important;\r\n  color: #515a6e;\r\n  height: 40px;\r\n  font-size: 13px;\r\n}\r\n\r\n.el-tag--small {\r\n  margin-left: 5px;\r\n}\r\n.ccc {\r\n  background-size: 20px 20px !important;\r\n  width: 20px !important;\r\n  height: 20px !important;\r\n}\r\n</style>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=016f137a&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\bs\\\\wxw\\\\xy-dash-admin\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-016f137a\"]])\n\nexport default __exports__"],"names":["total","ref","codeData","remark","migrationList","dialogDelete","runShow","deleteId","initUserList","async","res","requestUtil","queryForm","value","data","records","getMigrationList","deleteById","handleSizeChange","size","current","downloadById","id","ElMessage","run","handleCurrentChange","name","__exports__"],"sourceRoot":""}